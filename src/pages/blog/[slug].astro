---
import { getCollection } from 'astro:content';
import Layout from '../../pages/Layout.astro';

// 1. Generar las rutas para cada post
export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(entry => ({
    params: { slug: entry.slug }, 
    props: { entry },
  }));
}

// 2. Obtener la información del post
const { entry } = Astro.props;
const { Content } = await entry.render(); // Esto transforma el Markdown en HTML
---

<Layout title={entry.data.title}>
  <article class="prose prose-lg dark:prose-invert max-w-none">
    <header class="mb-8">
      <h1 class="text-4xl font-extrabold mb-2">{entry.data.title}</h1>
      <div class="flex items-center gap-4 text-gray-500 dark:text-gray-400">
        <time>{entry.data.pubDate.toLocaleDateString()}</time>
        <span class="bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-2 py-0.5 rounded text-sm">
          {entry.data.category}
        </span>
      </div>
      {entry.data.image && (
        <img src={entry.data.image} alt={entry.data.title} class="w-full h-auto rounded-xl mt-6 shadow-lg" />
      )}
    </header>

    <div class="mt-8">
      <Content />
    </div>
  </article>

  <div class="mt-12 pt-6 border-t dark:border-gray-700">
    <a href="/blog" class="text-blue-600 dark:text-blue-400 hover:underline">
      ← Volver a todos los artículos
    </a>
  </div>
</Layout>